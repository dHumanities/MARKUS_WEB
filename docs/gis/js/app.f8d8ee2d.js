(function(e){function t(t){for(var a,s,o=t[0],c=t[1],p=t[2],u=0,d=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,p||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},i=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var p=0;p<o.length;p++)t(o[p]);var l=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var a=r("85ec"),n=r.n(a);n.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Home")],1)},i=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home"},[r("l-map",{ref:"myMap",style:e.style,attrs:{id:"mapid",zoom:e.zoom,center:e.center},on:{click:e.onMapClick}},[r("l-control-layers",{attrs:{position:"topright"}}),e._l(e.tileProviders,(function(e){return r("l-tile-layer",{key:e.name,attrs:{name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"}})})),e._l(e.overlaymapsProviders,(function(e){return r("l-tile-layer",{key:e.name,attrs:{name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,opacityopacity:"0.9","layer-type":"overlay"}})}))],2),r("div",{attrs:{id:"list"}},[e._l(e.places,(function(t){return r("span",{key:t.sys_id},[r("a",{staticClass:"hook",attrs:{id:t.sys_id},on:{click:function(r){return e.sent(t)}}},[e._v(e._s(t.sys_id))]),r("br"),e._v(" "+e._s(t.name)+" "+e._s(t["parent name"])+" "),r("br"),r("span",{},[e._v(e._s(t.years?"("+t.years+")":"")+" "+e._s(t["xy coordinates"]?"["+t["xy coordinates"]+"]":"No Geo-Information"))]),r("br"),r("br")])})),e._v(" "+e._s(0===e.places.length?"無資料 / None":"")+" "),r("br")],2)],1)},o=[],c=(r("99af"),r("4de4"),r("4160"),r("caad"),r("c975"),r("d81d"),r("45fc"),r("b0c0"),r("d3b7"),r("ac1f"),r("2532"),r("3ca3"),r("5319"),r("841c"),r("1276"),r("2ca0"),r("159b"),r("ddb0"),r("2b3d"),r("96cf"),r("1da1")),p=r("3835"),l=r("e11e"),u=r.n(l),d=r("2699"),m=r("a40a"),h=r("4e2b"),f=r("9ee8"),b=r("e464"),g=r("f60f"),y={name:"Home",components:{LMap:d["a"],LTileLayer:m["a"],LMarker:h["a"],LControlLayers:f["a"],LImageOverlay:b["a"],LPopup:g["a"]},data:function(){return{KP:null,init:!1,markerLatLng:[47.31322,-1.319482],style:"height: 0px; width:100%",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",allJson:[],mymap:null,list:"",places:[],zoom:3,center:[28,107],popup:u.a.popup(),markers:null,tileProviders:[{name:"Mapbox",visible:!0,attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',url:"https://api.tiles.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw"},{name:"OpenTopoMap",visible:!0,attribution:'Map data: {attribution.OpenStreetMap}, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png"},{name:"Stamen.Terrain",visible:!0,attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data {attribution.OpenStreetMap}',url:"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"},{name:"Esri.WorldImagery",visible:!0,attribution:"{attribution.Esri} &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},{name:"OpenStreetMap",visible:!0,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"CartoDB Positron",visible:!0,url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}],overlaymapsProviders:[{name:"1904日治臺灣堡圖(明治版)",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=JM20K_1904-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1921日治臺灣堡圖(大正版)",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=JM20K_1921-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1921日治地形圖",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=JM25K_1921-png-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1942日治地形圖(昭和修正版)",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=JM25K_1942-png-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1944日治地形圖(航照修正版)",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=JM25K_1944-png-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1989臺灣經建1版地形圖",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=TM25K_1989-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1993臺灣經建2版地形圖",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=TM25K_1993-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"2001臺灣經建3版地形圖",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=TM25K_2001-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"2003臺灣經建4版地形圖",visible:!1,url:"https://gis.sinica.edu.tw/tileserver/file-exists.php?img=TM25K_2003-jpg-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'},{name:"1953竹北二堡上北勢庄地籍圖",visible:!1,url:"https://gis.sinica.edu.tw/dijitu/file-exists.php?img=tj7a0421-png-{z}-{x}-{y}",attribution:'中央研究院 WMTS 服務"'}]}},watch:{allJson:function(){this.style="height: 350px; width:100%",this.drawMakers()}},methods:{sent:function(e){parent.postMessage(e.sys_id,"*")},drawMakers:function(){var e=this,t=this.allJson;null!==this.markers&&this.$refs.myMap.mapObject.removeLayer(this.markers),this.markers=u.a.markerClusterGroup();var r="";t.filter((function(e){return e["xy coordinates"].length>0})).forEach((function(t){var a=t.sys_id,n=t.name,i=t["parent name"],s=t.years,o=t["xy coordinates"].split(","),c=Object(p["a"])(o,2),l=c[0],d=c[1];r=r+'<br><span id="'+a+'"><a class="hook">'+a+"</a><br>"+n+" "+i+'<br><span class="">('+s+") ["+t["xy coordinates"]+"]</span></span><br>\n";var m=u.a.marker(new u.a.LatLng(d,l),{title:n});m.bindPopup("<a onclick='document.getElementById(\"".concat(a,"\").click()'>").concat(a,"</a><br/>").concat(n,"<br/>").concat(i,"<br/>").concat(s)),e.markers.addLayer(m)})),this.places=t,this.$refs.myMap.mapObject.addLayer(this.markers),this.$refs.myMap.mapObject._onResize()},onMapClick:function(){},text2Number:function(e){return e.replace("番","").replace("│","-").replace("|","-").replace("ノ","-").replace("之","-").replace(/○/g,"0").replace(/一/g,"1").replace(/二/g,"2").replace(/三/g,"3").replace(/四/g,"4").replace(/五/g,"5").replace(/六/g,"6").replace(/七/g,"7").replace(/八/g,"8").replace(/九/g,"9").replace(/十/g,"0")},dealCadastre:function(e){var t,r=!1,a="",n="",i={isCadastre:!1},s=/[一二三四五六七八九十○]{1,3}(│|\||ノ|番?之)[一二三四五六七八九十○]{1,3}/g;while(null!==(t=s.exec(e)))t.index===s.lastIndex&&s.lastIndex++,a=t[0],n=this.text2Number(t[0]),r=!0;if(!r)return i.isCadastre=!1,i;if(e=e.replace(a,n).replace(/\s/g,""),e.indexOf("土名")>-1){var o,c=/([\u4e00-\u9fa5]+堡)([\u4e00-\u9fa5]+庄)土名([\u4e00-\u9fa5]{2,4})(\d+)-(\d+)/g;while(null!==(o=c.exec(e)))o.index===c.lastIndex&&c.lastIndex++,i.isCadastre=!0,i.b=o[1],i.z=o[2],i.d=o[3],i.mn=o[4],i.sn=o[5]}else{var p,l=/([\u4e00-\u9fa5]+堡)([\u4e00-\u9fa5]+庄)(\d+)-(\d+)/g;while(null!==(p=l.exec(e)))p.index===l.lastIndex&&l.lastIndex++,i.isCadastre=!0,i.b=p[1],i.z=p[2],i.d="",i.mn=p[3],i.sn=p[4]}return i}},created:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n,i,s,o,p,l,u,d,m,h=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=new URLSearchParams(window.location.search).get("n"),r){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,t("https://dhumanities.github.io/markus/js/kPlaceLatLon.json");case 6:if(a=e.sent,n=this.dealCadastre(r),i=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(r){var a,n,i,s,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:function(){return!0},e.prev=1,e.next=4,t(r);case 4:n=e.sent,i=n.placenames,s=void 0===i?[]:i,h.allJson=h.allJson.concat(s.filter(a)),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),!n.isCadastre){e.next=15;break}return s="https://docusky.org.tw/DocuSky/docutools/geocode/twcada.php?t=&b=".concat(encodeURIComponent(n.b),"&z=").concat(encodeURIComponent(n.z),"&d=").concat(encodeURIComponent(n.d),"&n=").concat(n.mn),e.next=13,i(s);case 13:e.next=44;break;case 15:if(!r.includes("twcada_")){e.next=20;break}return e.next=18,i("https://docusky.org.tw/DocuSky/docutools/geocode/twcada.php?n=".concat(r));case 18:e.next=44;break;case 20:return e.next=22,i("https://docusky.org.tw/DocuSky/docutools/geocode/tw.php?n=".concat(encodeURIComponent(r)));case 22:if(!r.startsWith("hvd_")){e.next=39;break}return e.prev=23,o="https://maps.cga.harvard.edu/tgaz/placename/json/".concat(r),e.next=27,t(o);case 27:return p=e.sent,l=p.spellings,u=l[0]["written form"],e.next=32,i("https://maps.cga.harvard.edu/tgaz/placename?fmt=json&n=".concat(u),(function(e){return e.sys_id===r}));case 32:e.next=37;break;case 34:e.prev=34,e.t0=e["catch"](23),console.error(e.t0);case 37:e.next=41;break;case 39:return e.next=41,i("https://maps.cga.harvard.edu/tgaz/placename?fmt=json&n=".concat(r));case 41:d=decodeURIComponent(r).split("|"),m=a.filter((function(e){return d.some((function(t){return e[2].includes(t)||"koreanPlace_".concat(e[0])===t}))})).sort((function(e,t){return e[2].length-t[2].length})),this.allJson=this.allJson.concat(m.map((function(e){return{sys_id:"koreanPlace_".concat(e[0]),name:"".concat(e[2]).concat(e[3]?"(".concat(e[3],")"):""),transcription:"",years:e[4]||"","parent sys_id":"","parent name":"","feature type":"POINT","xy coordinates":e[6]?"".concat(e[6],",").concat(e[7]):"","data source":""}})));case 44:case"end":return e.stop()}}),e,this,[[23,34]])})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){var e=this;this.$nextTick((function(){e.drawMakers()}))}},v=y,x=(r("cccb"),r("2877")),w=Object(x["a"])(v,s,o,!1,null,null,null),k=w.exports,M={components:{Home:k}},_=M,S=(r("034f"),Object(x["a"])(_,n,i,!1,null,null,null)),j=S.exports,O=(r("6cc5"),r("ca9f")),I=r.n(O);delete u.a.Icon.Default.prototype._getIconUrl,u.a.Icon.Default.mergeOptions({iconRetinaUrl:r("584d"),iconUrl:r("6397"),shadowUrl:r("e2b9")}),a["a"].config.productionTip=!1,a["a"].component("v-marker-cluster",I.a),new a["a"]({render:function(e){return e(j)}}).$mount("#app")},"5ced":function(e,t,r){},"85ec":function(e,t,r){},cccb:function(e,t,r){"use strict";var a=r("5ced"),n=r.n(a);n.a}});
//# sourceMappingURL=app.f8d8ee2d.js.map